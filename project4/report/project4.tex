\documentclass[a4paper, fontsize=11pt]{article}

\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage[english]{babel} % English language/hyphenation
%\usepackage{hyperref}
\usepackage{listings}
\usepackage{color}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{float}
\usepackage{pgfplotstable, booktabs, mathpazo}
\usepackage{diagbox}
\usepackage{multirow}


\usepackage[colorlinks=true,linkcolor=black,urlcolor=blue,
citecolor=blue]{hyperref}

%\bibliographystyle{ieeetr}
\bibliographystyle{apalike}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}


\lstset{frame=tb,
  language=C++,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

\pgfplotstableset{
    every head row/.style={before row=\toprule,after row=\midrule},
    every last row/.style={after row=\bottomrule}
}

\begin{document}

\title{Project 4 FYS4150 \\ Phase transitions in magnetic systems}
\author{Marius Holm}

%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------
\maketitle


\section{Abstract}
We give a brief introduction to differential equations and how we can discretize such equations in order to solve them using computer algorithms. We then introduce the most important equations we meet in our project, namely Newton's law of gravitation, and Newton's second law of motion on differential form. In table \ref{PlanetMass} we present the masses and distance from the Sun of all the planets in our solar system. We choose to scale our equations in such a way that the mass of the Sun is $M_{\odot}\overset{\text{def}}{=} 1$, and as such we also need the masses of the planets given in the same unit.


\paragraph{}
We find an analytical expression for the escape velocity needed for a planet to escape the gravitational pull of the Sun, $v_{e} = 2\sqrt{2} \, \pi$. We then present plots of Mercury's perihelion precession and how Mercury's orbit around the Sun is affected by general relativity.


\paragraph{}
The rest of our results can be found in the GitHub repository linked in the implementation section. 

\section{Introduction}
In this project we will study the Ising model in two dimensions as a model of phase transitions. At a given critical temperature, this model exhibits a phase transition from a magnetic phase to a phase with zero magnetization. This is a so-called binary system where each object on the lattice can only take two values. In our system we will use spins that either point up or down. We can for example choose to associate spins pointing up with 1, and spins pointing down with 0. 

\paragraph{}
In it's simplest form the energy of the Ising model is expressed as, without an externally applied magnetic field,

\begin{equation}
E = -J \sum^N_{<kl>} s_{k} s_{l},
\end{equation}

with $s_{k}=\pm 1$. $N$ is the total number of spins in our system and $J$ is a coupling constant expressing the strength of the interaction between neighboring spins. The symbol $<kl>$ indicates that we sum over the nearest neighbors only. For non-neighboring spins the interaction is so weak that we often can ignore this contribution. We also assume that we have ferromagnetic ordering in our system, by assuming $J> 0$. For this project we'll use periodic boundary conditions and the Metropolis algorithm.


\paragraph{}
We give a brief introduction to the Ising model as well as phase transitions near the critical temperature. For a simple system of $2 \times 2$ spins, $L = 2$ we present the analytical expressions for the partition function and the corresponding expectation values for the energy $E$, the mean absolute value of the magnetic moment $\lvert M \rvert$ (we refer to this as the mean magnetization), the specific heat $C_{V}$ and the susceptibility $\chi$ as functions of $T$ using periodic boundary conditions. We then present and discuss the numerical results obtained from our code.



\section{Methods}




\subsection{Monte Carlo}



\subsection{Ising model}




\subsubsection{Euler's forward algorithm}


\subsubsection{Euler's method specific}



\subsubsection{Velocity Verlet method}



\subsection{Implementation}

In our implementation of the abovementioned methods we use a more general scheme which allows us to implement any given formula for the acceleration. Thus we are not limited to the specified acceleration derived from circular motion, but have the opportunity to add other terms as well. 


\paragraph{}
All our code, calculations, and plots used can be found in \href{https://github.com/auduntre/FYS4150/tree/master/Project%203}{Auduns GitHub repository}.

\section{Results}


\subsection{Analytic expressions}
We assume we have a system of two spins in each dimension, denoted as $L = 2$, with periodic boundary conditions. For a square lattice with periodic boundary conditions we have $2^4 = 16$ states. 


\begin{table}[h!]
\centering
\begin{tabular}{|c|| >{\centering}m{1cm}| >{\centering}m{1cm}| >{\centering}m{1cm}| >{\centering}m{1cm}|}
\toprule
\multicolumn{5}{c}{Spin configurations}
%Spin configurations
\\ \hline
\diagbox{$k$}{$j$} & $1$ & $2$ & $3$ & $4$
\tabularnewline
\hline
\multirow{2}{*}{$1$} & $\uparrow \uparrow$ & $\uparrow \uparrow$ & 
$\uparrow \uparrow$ & $\uparrow \uparrow$ 
\tabularnewline
& $\uparrow \uparrow$ & $\uparrow \downarrow$ & 
$\downarrow \uparrow$ & $\downarrow \downarrow$
\tabularnewline
\hline
\multirow{2}{*}{$2$} & $\uparrow \downarrow$ & $\uparrow \downarrow$ & 
$\uparrow \downarrow$ & $\uparrow \downarrow$ 
\tabularnewline
& $\uparrow \uparrow$ & $\uparrow \downarrow$ & 
$\downarrow \uparrow$ & $\downarrow \downarrow$
\tabularnewline
\hline
\multirow{2}{*}{$3$} & $\downarrow \uparrow$ & $\downarrow \uparrow$ & 
$\downarrow \uparrow$ & $\downarrow \uparrow$ 
\tabularnewline
& $\uparrow \uparrow$ & $\uparrow \downarrow$ & 
$\downarrow \uparrow$ & $\downarrow \downarrow$
\tabularnewline
\hline
\multirow{2}{*}{$4$} & $\downarrow \downarrow$ & $\downarrow \downarrow$ & 
$\downarrow \downarrow$ & $\downarrow \downarrow$ 
\tabularnewline
& $\uparrow \uparrow$ & $\uparrow \downarrow$ & 
$\downarrow \uparrow$ & $\downarrow \downarrow$
\tabularnewline \hline
\end{tabular}
\caption{Spin configurations for a $2 \times 2$ system.}
\label{spinconfig}
\end{table}





In order to calculate the expectation values for the mean energy $\langle E \rangle$ and the mean magnetization $\langle \mathcal{M} \rangle$ in statistical physics at a given temperature, we need a probability distribution

\begin{equation}
P_{i}(\beta) = \dfrac{e^{-\beta E_{i}}}{Z}
\end{equation}

which is known as the Boltzmann distribution with $\beta = 1/kT$, where $k$ is the Boltzmann constant, $E_{i}$ the energy of a state $i$, and $Z$ is the partition function for the canonical esemble defined as 

\begin{equation}
Z = \sum^M_{i=1} e^{-\beta E_{i}}
\end{equation}

where the sum extends over all microstates $M$. 

\paragraph{}
With periodic boundary conditions the energy for a given configuration $i$ is given by

\begin{equation}
E_{i} = \sum^N_{j=1} s_{j} s_{j+1}. 
\end{equation}

For details on the calculations and more theoretical background please see. \cite{H-Jensen}

\paragraph{}

\begin{table}[h!]
\centering
\begin{tabular}{|c||c|r|r|}
\toprule
\multicolumn{4}{c}{Energy and magnetization}
%Spin configurations
\\ \hline
Spins $\uparrow$ & Degeneracy & $E$ & $\mathcal{M}$
\tabularnewline
\hline
4 & 1 & $-8$ J & $4$
\tabularnewline \hline
3 & 4 & $0$ & $2$
\tabularnewline \hline
2 & 4 & $0$  & $0$
\tabularnewline \hline
2 & 2 & $8$ J & $0$
\tabularnewline \hline
1 & 4 & $0$  & $-2$
\tabularnewline \hline
0 & 1 & $-8$ J & $-4$
\tabularnewline \hline
\end{tabular}
\caption{Energy and magnetization of the different spin configurations described in table \ref{spinconfig}.}
\label{EM}
\end{table}

We can now find an analytic expression for the partition function for our $2 \times 2$ system. We have $M = 16$ different configurations. For the different configurations we have two configurations with $E = -8 \, \text{J}$, two with $E = 8 \, \text{J}$, and $12$ of $E=0$. Thus we have

\begin{equation}
Z = 2 e^{-8\, \text{J} \, \beta} + 2 e^{8 \,\text{J} \, \beta} + 12,
\end{equation}

where the first term is a result from the two configurations $j,k=1,1$ and $j,k = 4,4$. The second term comes from configurations $j,k = 3,2$ and $j,k = 2,3$, while the last term is the contribution from the rest of the configurations with $E=0$.

\paragraph{}
The corresponding expectation values for the energy is given by

\begin{equation}
\langle E \rangle = \sum^M_{i=1} E_{i} \, P_{i}(\beta) = \sum^M_{i=1} E_{i} \, \dfrac{e^{-\beta \, E_{i}}}{Z} = -\dfrac{J}{Z} \left(16 e^{8 \, \text{J} \, \beta} - 16 e^{-8 \, \text{J} \, \beta} \right)
\end{equation}

The variance is defined as

\begin{equation}
\sigma^2_{E} = \left( \langle E^2 \rangle - \langle E \rangle^2 \right) = \dfrac{1}{Z} \sum^M_{i=1} E_{i}^2 \, e^{-\beta \, E_{i}} - \left( \dfrac{1}{Z} \sum^M_{i=1} E_{i} \, e^{-\beta \, E_{i}} \right)^2
\end{equation}

We use this result in order to find the specific heat  $C_{V}$ as

\begin{equation}
C_{V} = \dfrac{1}{k_{B} \, T^2} \left( \langle E^2 \rangle - \langle E \rangle^2 \right)
\end{equation}

\paragraph{}
The mean absolute magnetization $\langle \mathcal{M} \rangle$ can be calculated as

\begin{equation}
\langle \mathcal{M} \rangle = \sum^M_{i=1} \mathcal{M}_{i} \, P_{i}(\beta) = \dfrac{1}{Z} \sum^M_{i=1} \mathcal{M}_{i} \, e^{-\beta \, E_{i}}
\end{equation}

where $\mathcal{M}_{i}$ is the magnetization for a given configuration $i$ calculated as

\begin{equation}
\mathcal{M}_{i} = \sum^N_{j=1} s_{j}
\end{equation}

where we sum over each spin in the lattice, counting up spins as $+1$ and down spins as $-1$. The magnetization of each "equivalent" configuration is given in table \ref{EM}. As such we can calculate $\langle \mathcal{M} \rangle$ as

\begin{equation}
\langle \mathcal{M} \rangle = \dfrac{1}{Z} \left( 4 \, e^{8 \, \text{J} \, \beta} + 4 (2 \, e^0) + 4 ( -2 \, e^0) -4 \, e^{8 \, \text{J} \, \beta} \right) = 0
\end{equation}

The variance is defined as 

\begin{equation}
\sigma^2_{\mathcal{M}} = \left( \langle \mathcal{M}^2 \rangle - \langle \mathcal{M} \rangle^2 \right) = \dfrac{1}{Z} \sum^M_{i=1} \mathcal{M}_{i}^2 \, e^{-\beta \, E_{i}} - \left( \dfrac{1}{Z} \sum^M_{i=1} \mathcal{M}_{i} \, e^{-\beta \, E_{i}} \right)^2
\end{equation}

We use this result in order to calculate the susceptibility $\chi$ as

\begin{equation}
\chi = \dfrac{1}{k_{B} \, T} \left( \langle \mathcal{M}^2 \rangle - \langle \mathcal{M} \rangle^2 \right)
\end{equation}


\cite{H-Jensen}

\subsection{FLOPS}




\subsection{Escape velocity}






\subsection{Perihelion precession of Mercury}




\subsection{Method stability} 




As we can see from figures \ref{fig:Verlet} and \ref{fig:Euler}, we can achieve pretty nice results using both Euler's forward algorithm as well as the velocity Verlet algorithm. However we notice that in order to get a nice circular orbit we need 100 times more timesteps for Euler's method compared to velocity Verlet. I.e. in order to avoid divergence, Euler's method requires significantly more time steps.


%\paragraph{}
%Testing Anders' code for automatic inclusion of data to table.
%\begin{table}[h!t
%    \centering
%    \caption{The greatest table.}
%    \pgfplotstabletypeset[sci]{error.dat}
%\end{table}

\section{Conclusions}

The results found using numerical methods with general relativity correction terms fit very well with known theory. We did not have the time to expand our code to a full solar system with all the planets, which would have been interesting to look at given we had more time.



\bibliography{references}
\end{document}